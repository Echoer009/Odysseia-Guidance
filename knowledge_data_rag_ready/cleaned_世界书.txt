### **SillyTavern 世界书 (Lorebook) 基础概念与作用**

简单来说，世界书是一个 **动态的的信息库**。它可以为 AI 提供精确的背景知识，同时保持聊天界面的干净整洁。无论是宏大的原创世界观，还是某个角色的特殊习惯，都可以交给世界书来管理。

例如，你可以将关于“海绵宝宝”🍍 和“蟹堡王”🍔 的介绍预先写在世界书的条目里。当对话中提到相关关键词时，AI 就能立刻“回忆”起这些设定，从而给出更精准的回复。

---RAG-CHUNK---

### **世界书界面入门：如何创建世界书与条目**

1.  在 SillyTavern 的顶部菜单栏，找到并点击 **书本+地球** 🌍 的图标，即可打开世界书面板。
2.  点击 **“🌐新建”**，并为你的新世界书取一个清晰，容易分辨的名字。
    *   注意：为兼容性考虑，推荐世界书名字中不要带有emoji。
3.  接着，点击 **“新建条目”**，创建你的第一个信息卡片。

---RAG-CHUNK---

### **世界书条目核心设置：触发、位置与顺序**

这三个设置决定了你的信息将**如何被触发**、**插入到哪里**以及**排列顺序**。

1.  **触发策略**: 决定条目何时被激活。
    *   🔵 **蓝灯:** 始终激活。
    *   🟢 **绿灯:** 关键词触发。
    *   ⛓️ **锁链**: 向量化触发 (不常用)。
2.  **插入位置**: 决定条目内容将被安插在发送给 AI 的总提示词的哪个部分。常用位置有“角色定义之前/之后”和“@D⚙️ /👨/🤖”（作为一条聊天记录插入）。
3.  **深度**: **仅在插入位置选择 @D 时可见**。它决定了条目内容插入到聊天记录的“多深”处。数字越小，越靠近底部，影响力越强。
4.  **顺序**: 决定了在**相同插入位置**的多个条目之间的前后顺序。**数字越小，越靠前。**

---RAG-CHUNK---

### **绿灯（关键词触发）条目的高级设置与技巧**

*   **主要关键字**: **绿灯条目的灵魂**。必须使用**英文逗号** `,` 分隔多个关键词。
*   **逻辑 & 可选过滤器**: 用于设置更复杂的触发条件，如“与任意 (AND ANY)”、“非任意 (NOT ANY)”等。对于新手，只使用“主要关键字”就足够了。
*   **递归扫描**: 由于推荐的全局设置启用了递归扫描，一个世界书条目中的内容也可能触发其他绿灯条目。因此，**强烈推荐开启所有蓝灯条目的‘防止进一步递归’**，以防绿灯被意外触发。

---RAG-CHUNK---

### **世界书条目内容与定时选项（黏性、冷却）**

*   **内容区** ✍️: 这里就是你希望发送给 AI 的具体内容了。
*   **定时选项**:
    *   **黏性**: 如果一个绿灯条目设置了 黏性: 5，那么它在被触发一次后，即使后续对话中不再出现关键词，它也会**在接下来的 5 次对话中持续生效**。
    *   **冷却**: 与“黏性”相对。如果设置了 冷却: 5，那么该条目在触发一次后，即使满足条件，也必须**等待 5 次对话之后**，才能再次触发。
    *   **延**: 设定聊天记录中必须有多少条消息后，此条目才能开始被触发。不常用。

---RAG-CHUNK---

### **实战指南第一步：明确世界书的创作核心**

在动手之前，请先思考：**你最想通过世界书表达什么？** 是庞大独特的世界观，还是性格复杂的角色设定？首先在脑海中构思一个清晰的**大纲**。不必自行填充每一个细节，但那个独一无二、充满创意的**灵感**，才是整个世界书的灵魂。

---RAG-CHUNK---

### **实战指南第二步：选择适合AI理解的格式 (XML, YAML, Markdown)**

不同模型接受得最好的格式并不相同，但毫无分隔的大段自然语言肯定不便于AI理解。目前的主流格式是：**XML 标签 + Markdown** 或 **XML 标签 + JSON/YAML**。

*   **XML 标签 (<tag></tag>)**: 常被用作**内容分隔符**和**“副标题”**。
*   **JSON / YAML (key: value)**: 介于伪代码和自然语言之间，AI对这种格式的理解似乎更强。
*   **Markdown (# 标题, *加粗*)**: AI常用的输出格式，同样优于纯文本。

**重要提示：**
1.  **AI 不是代码执行器**：这些格式只是为了更好地**组织和呈现信息**。
2.  **善用工具**：社区中有大量的“写卡机”或“写卡预设”，可以帮助你快速生成结构化的世界书条目。

---RAG-CHUNK---

### **实战指南第三步：精简内容，专注于独创或AI易错部分**

主流模型拥有极其庞大的知识库，这意味着：**它已经知道很多事了。** 核心原则是：**专注于你独创的内容，或 AI 容易出错的部分。**

*   **无需重述大 IP 基础设定**：写《哈利·波特》的同人故事时，你不需要花费篇幅介绍霍格沃茨是什么。
*   **重点是补充或纠错**：如果你发现 AI 总是弄错某个设定，你需要创建一个专门的条目来清晰地指出正确信息。
*   **写多长？** 如果你对某个细节**没有明确的想法**，那就**留空**，让 AI 自由发挥。如果你**有非常明确的想法**，那就把它**清晰地写下来**。

---RAG-CHUNK---

### **实战指南第四步：蓝灯与绿灯的策略性使用**

*   **蓝灯：**无论如何都会被发送给AI。
*   **绿灯：**只有在上下文中出现关键词时，才会被发送给AI。

全部使用蓝灯固然方便，但会导致上下文过长，且包含大量对当前情景无用的信息。合理使用绿灯，可以在需要时动态加载信息，节约上下文空间。但绿灯也有缺点，比如关键词可能被循环触发，或难以实现复杂的阶段性人设。更高级的控制方法需要借助变量系统等插件。

---RAG-CHUNK---

### **实战指南第五步：利用插入位置和顺序控制AI注意力**

根据“U形注意力”现象，靠近整段提示词**顶部和底部的内容影响更强。** 在世界书中，通常：

*   插入到**深度0的条目 的影响最大**。
*   使用“角色定义之前/之后”等位置的条目，会随着聊天记录变长而被向上推，效力相应减弱。
*   使用固定较低深度@D插入的条目，能始终保持较强效力。

**总结：你越希望AI绝对地遵守世界书中的哪些规则，就越把它放到靠近深度0的位置。** 但要注意，**什么都强调就等于什么都没强调。**把所有条目都放在D0，只会把AI彻底弄混乱。

---RAG-CHUNK---

### **进阶技巧：通过示例、平衡语料和手动润色提升世界书效果**

这部分纯出于作者的个人经验和理解：

1.  **给示例，而不是堆标签**: 在描述角色性格等抽象概念时，与其简单地贴标签（如“冷静”），不如**给出一个生动的场景示例**来展示其性格，这样效果更佳。
2.  **给多少示例或语料？**: 需要在测试中找到平衡点。示例过少，AI容易“不听话”；示例过多，AI又会“过拟合”，只会照抄示例而失去创造力。
3.  **适当手写**: AI会模仿上文的文风，如果放任其模仿自己，文风会越来越“八股”。建议卡的**开场白**或世界书中影响正文的**语料**进行**手写或润色**，以避免AI的文风“过拟合”。